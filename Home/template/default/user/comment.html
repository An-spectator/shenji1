<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noindex,noarchive">

	
	<title>评论列表-{$webconf['web_name']}</title>
	<meta property="og:title" 	content="评论列表-{$webconf['web_name']}" />
	<meta name="twitter:title" 	content="评论列表-{$webconf['web_name']}" />
	<meta name="keywords" content="评论列表-{$webconf['web_keyword']}" />
	<meta name="description"  content="评论列表-{$webconf['web_desc']}" />
	{include="user/user-style"}

</head>
<body>
{include="user/user-top"}
<section class="container py-3">
	<div class="row justify-content-center">
		<div class="col-lg-10 step mb-2">
			{include="user/user-content"}
		</div>
		<div class="col-12 step">
			<fieldset>
				<div style="width:100%;  overflow:scroll;overflow-y: hidden">
				<table border="1" rules="all" style="width:100%; height:100px; text-align:center;white-space:nowrap" class="table table-striped table-bordered">
					<thead><!--好像沒必要-->
						<label class="h5">评论列表</label>
					</thead>
					<tbody>
						<tr class="table-primary">
							<th class="num text-center">#</th>
							<th style="text-left">标题/内容</a></th>
							<th class="num text-center">数量</th>
							<th class="num text-center">时间</th>
							<th class="num text-center">操作</th>
						</tr>
						{if($lists)}
						{foreach $lists as $v}
						<tr>					
							<td class="text-center">{$v['id']}</td>
							<td>
								<a href="{$v['url']}" {if($v['isread']==1)}style="color:gray"{/if} >{if($v['isread']==1)}【已读】{else}【未读】{/if}{$v['title']}<a/>
								<p class="mb-0"><cite>{$v['body']}</cite></p>
							</td>
							<td class="text-center"><i class="fa fa-commenting-o mr-1"></i>(<span>{$v['comment_num']}</span>)</td>
							<td class="text-center">{$v['date']}</td>
							<td class="text-center"><a href="javascript:if(confirm('確定要刪除评论嗎？'))window.location.href='{$v['comment_del']}'">刪除</a></td>
						</tr>
						{/foreach}
						{if(!isMobile())}
						<tr class="page"><td colspan="5">{$pages}</td></tr>
						{/if}
						{else}
						<tr><td colspan="5">没有任何评论哦~</td></tr>
						{/if}
						<tr id="more"></tr>
					</tbody>
				</table>
			</div>
			</fieldset>
			
		</div>
	</div>
</section>
{include="user/common"}

{if(isMobile())}
<script>
var p=1;
$(window).scroll(function () {
	//判断是否滑动到页面底部
	
	if ($(window).scrollTop() === ($(document).height() - $(window).height()) ) {	
		p++;
		$.ajax({
		 url:"{fun U('User/comment')}", 
		 dataType:"json",
		 async:true,
		 data:{page:p,ajax:1,iscode:1},
		 type:"POST",//请求方式
		 beforeSend:function(){
		//请求前的处理
		},
		 success:function(r){
		//请求成功时处理
				if(r.code==0){
					var html = '';
					var leng = r.data.length;
					if(leng>0){
						for(var i=0;i<leng;i++){
							html+='<tr>'+
							'<td class="text-center">'+r.data[i].id+'</td>';
							if(r.data[i]['isread']==1){
								html+='<td><a href="'+r.data[i].url+'" style="color:gray">【已读】'+r.data[i].title+'<a/><p class="mb-0"><cite>'+r.data[i].body+'</cite></p></td>';
							}else{
								html+='<td><a href="'+r.data[i].url+'" >【未读】'+r.data[i].title+'<a/><p class="mb-0"><cite>'+r.data[i].body+'</cite></p></td>';
							}
							html+='<td class="text-center"><i class="fa fa-commenting-o mr-1"></i>(<span>'+r.data[i].comment_num+'</span>)</td>'+
							'<td class="text-center">'+r.data[i].date+'</td>'+
							'<td class="text-center"><a href="javascript:if(confirm(\'確定要刪除评论嗎？\'))window.location.href=\''+r.data[i].comment_del+'\'">刪除</a></td></tr>';
						}
						$("#more").before(html);
					}
				}else{
					alert(r.msg);
					return false;
				}
		},
		 complete:function(){
		//请求完成的处理
		},
		 error:function(){
		//请求出错处理
				alert('網絡異常');
		}

			
			
		})
	
	
	}
})
</script>
{/if}

</body>
</html>